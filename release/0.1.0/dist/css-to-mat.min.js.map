{"version":3,"file":"css-to-mat.min.js","sources":["../src/CSSToMatrix.ts"],"sourcesContent":["import { mat4 } from \"gl-matrix\";\nimport { splitComma, splitBracket, splitUnit, splitSpace, isArray } from \"@daybrush/utils\";\nimport { MatrixInfo } from \"./types\";\n\nexport function parseMat(transform: string | string[]): number[] {\n    return toMat(parse(transform));\n}\nexport function toMat(matrixInfos: MatrixInfo[]): number[] {\n    const target = [\n        1, 0, 0, 0,\n        0, 1, 0, 0,\n        0, 0, 1, 0,\n        0, 0, 0, 1,\n    ];\n\n    matrixInfos.forEach(info => {\n        const {\n            functionName,\n            functionValue,\n        } = info;\n\n        if (!functionName) {\n            return;\n        }\n        (mat4 as any)[functionName](target, target, functionValue);\n    });\n    return target;\n}\nexport function parse(transform: string | string[]): MatrixInfo[] {\n    const transforms = isArray(transform) ? transform : splitSpace(transform);\n\n    return transforms.map(t => {\n        const { prefix: name, value } = splitBracket(t);\n\n        let functionName: keyof typeof mat4 | \"\" = \"\";\n        let functionValue: any = \"\";\n\n        if (name === \"translate\" || name === \"translateX\" || name === \"translate3d\") {\n            const [posX, posY = 0, posZ = 0] = splitComma(value!).map(v => parseFloat(v));\n\n            functionName = \"translate\";\n            functionValue = [posX, posY, posZ];\n        } else if (name === \"translateY\") {\n            const posY = parseFloat(value!);\n\n            functionName = \"translate\";\n            functionValue = [0, posY, 0];\n        } else if (name === \"translateZ\") {\n            const posZ = parseFloat(value!);\n\n            functionName = \"translate\";\n            functionValue = [0, 0, posZ];\n        } else if (name === \"scale\" || name === \"scale3d\") {\n            const [sx, sy = sx, sz = 1] = splitComma(value!).map(v => parseFloat(v)) as number[];\n\n            functionName = \"scale\";\n            functionValue = [sx, sy, sz];\n        } else if (name === \"scaleX\") {\n            const sx = parseFloat(value!);\n\n            functionName = \"scale\";\n            functionValue = [sx, 1, 1];\n        } else if (name === \"scaleY\") {\n            const sy = parseFloat(value!);\n\n            functionName = \"scale\";\n            functionValue = [1, sy, 1];\n        } else if (name === \"scaleZ\") {\n            const sz = parseFloat(value!);\n            functionName = \"scale\";\n            functionValue = [1, 1, sz];\n        } else if (name === \"rotate\" || name === \"rotateZ\" || name === \"rotateX\" || name === \"rotateY\") {\n            const { unit, value: unitValue } = splitUnit(value!);\n            const rad = unit === \"rad\" ? unitValue : unitValue * Math.PI / 180;\n\n            functionName = name === \"rotate\" ? \"rotateZ\" : name;\n            functionValue = rad;\n        } else if (name === \"matrix3d\") {\n            functionName = \"multiply\";\n            functionValue = splitComma(value!).map(v => parseFloat(v));\n        } else if (name === \"matrix\") {\n            const m = splitComma(value!).map(v => parseFloat(v));\n            functionName = \"multiply\";\n            functionValue = [\n                m[0], m[1], 0, 0,\n                m[2], m[3], 0, 0,\n                0, 0, 1, 0,\n                m[4], m[5], 0, 1,\n            ];\n        }\n        return {\n            name: name!,\n            value: value!,\n            functionName,\n            functionValue,\n        };\n    });\n}\n"],"names":["toMat","matrixInfos","target","forEach","info","functionName","functionValue","mat4","parse","transform","isArray","splitSpace","map","t","_a","name","value","_b","posX","_c","posY","_d","parseFloat","_e","sx","_f","sy","_g","_h","unit","unitValue","Math","PI","splitComma","v","m"],"mappings":";;;;;;;;quiBAOgBA,EAAMC,OACZC,EAAS,CACX,EAAG,EAAG,EAAG,EACT,EAAG,EAAG,EAAG,EACT,EAAG,EAAG,EAAG,EACT,EAAG,EAAG,EAAG,UAGbD,EAAYE,QAAQ,SAAAC,OAEZC,iBACAC,kBAGCD,GAGJE,EAAaF,GAAcH,EAAQA,EAAQI,KAEzCJ,WAEKM,EAAMC,8CACCC,CAAQD,GAAaA,6BAAYE,CAAWF,IAE7CG,IAAI,SAAAC,OACZC,8HAAEC,WAAcC,UAElBX,EAAuC,GACvCC,EAAqB,MAEZ,cAATS,GAAiC,eAATA,GAAkC,gBAATA,EAAwB,KACnEE,8CAACC,OAAMC,OAAAC,iBAAUC,OAEvBhB,EAAe,YACfC,EAAgB,CAACY,EAAME,uBACpB,GAAa,eAATL,EAAuB,CAG9BV,EAAe,YACfC,EAAgB,CAAC,EAHXc,EAAOE,WAAWN,GAGE,QACvB,GAAa,eAATD,EAAuB,CAG9BV,EAAe,YACfC,EAAgB,CAAC,EAAG,EAHPgB,WAAWN,SAIrB,GAAa,UAATD,GAA6B,YAATA,EAAoB,KACzCQ,8CAACC,OAAIC,OAAAC,iBAASC,OAEpBtB,EAAe,QACfC,EAAgB,CAACkB,EAAIE,uBAClB,GAAa,WAATX,EAAmB,CAG1BV,EAAe,QACfC,EAAgB,CAHVkB,EAAKF,WAAWN,GAGD,EAAG,QACrB,GAAa,WAATD,EAAmB,CAG1BV,EAAe,QACfC,EAAgB,CAAC,EAHXoB,EAAKJ,WAAWN,GAGE,QACrB,GAAa,WAATD,EAAmB,CAE1BV,EAAe,QACfC,EAAgB,CAAC,EAAG,EAFTgB,WAAWN,SAGnB,GAAa,WAATD,GAA8B,YAATA,GAA+B,YAATA,GAA+B,YAATA,EAAoB,KACtFa,2LAAEC,SAAMC,UAGdzB,EAAwB,WAATU,EAAoB,UAAYA,EAC/CT,EAHqB,QAATuB,EAAiBC,EAAYA,EAAYC,KAAKC,GAAK,SAI5D,GAAa,aAATjB,EACPV,EAAe,WACfC,EAAgB2B,EAAWjB,GAAQJ,IAAI,SAAAsB,UAAKZ,WAAWY,UACpD,GAAa,WAATnB,EAAmB,KACpBoB,EAAIF,EAAWjB,GAAQJ,IAAI,SAAAsB,UAAKZ,WAAWY,KACjD7B,EAAe,WACfC,EAAgB,CACZ6B,EAAE,GAAIA,EAAE,GAAI,EAAG,EACfA,EAAE,GAAIA,EAAE,GAAI,EAAG,EACf,EAAG,EAAG,EAAG,EACTA,EAAE,GAAIA,EAAE,GAAI,EAAG,SAGhB,CACHpB,KAAMA,EACNC,MAAOA,EACPX,eACAC,4CA1FaG,UACdT,EAAMQ,EAAMC"}